name: üîÅ Update LICENSE Year

on:
  workflow_dispatch: # Run manually
  schedule:
    - cron: '0 0 1 1 *' # Yearly, Jan 1

jobs:
  update-year:
    runs-on: ubuntu-latest

    steps:
      - name: üßæ Checkout repository
        uses: actions/checkout@v3

      - name: üìÖ Get current year
        run: echo "YEAR=$(date +'%Y')" >> $GITHUB_ENV

      - name: üõ† Update year in LICENSE file
        run: |
          OLD_YEAR=$(grep -oP 'Copyright \(c\) \K[0-9]{4}(?= Tirth Patel)' LICENSE)
          if [ "$OLD_YEAR" != "$YEAR" ]; then
            sed -i "s/Copyright (c) $OLD_YEAR Tirth Patel/Copyright (c) $YEAR Tirth Patel/" LICENSE
          fi

      - name: ‚úÖ Commit changes (if any)
        run: |
          git config user.name github-actions[bot]
          git config user.email github-actions[bot]@users.noreply.github.com
          
          if [[ $(git status --porcelain) ]]; then
            git commit -am "üîÅ Update LICENSE year to $YEAR"
            git push
          else
            echo "‚úÖ No changes to commit."
          fi
